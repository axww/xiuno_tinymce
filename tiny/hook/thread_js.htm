<?php //assbbs.com
echo '
<script>
var tiny_tid='.$thread['tid'].';
var tiny_page='.$page.';
var tiny_advanced=document.querySelector(\'#advanced_reply\');
var tiny_quotepid=document.querySelector(\'input[name="quotepid"]\');
// 高级回复继承
if(tiny_advanced){
tiny_advanced.setAttribute(\'href\',\'javascript:;\');
tiny_advanced.setAttribute(\'onclick\',\'window.location.href=\\\'./?post-create-\\\'+tiny_tid+\\\'-0-\\\'+tiny_quotepid.value+\\\'.htm#\\\'+encodeURIComponent(document.querySelector(\\\'#message\\\').value);\');
if(tiny_quotepid){new MutationObserver(function(){tiny_advanced.href=\'javascript:;\';}).observe(tiny_quotepid,{attributes:true});};
};
if(document.querySelector(\'#newfloor\')){
new MutationObserver(function(){
var tiny_last=new XMLHttpRequest();
tiny_last.open(\'GET\',\'./?tiny_jump&page=\'+tiny_tid+\'&time=\'+Date.parse(new Date()),true);
tiny_last.onreadystatechange=function(){
if(this.readyState===4&&this.status===200&&!isNaN(this.responseText)&&this.responseText>0&&this.responseText!=tiny_page){
window.location.href=xn.url(\'thread-\'+tiny_tid+\'-\'+this.responseText)+\'#jump\';
};
};
tiny_last.send(null);
}).observe(document.querySelector(\'#newfloor\'),{childList:true,characterData:true});
};
if(window.location.hash==\'#jump\'){
window.addEventListener(\'load\',function(){
var tiny_jump=document.getElementsByClassName(\'post\');
if(tiny_jump.item(tiny_jump.length-2)){$(window).scrollTop($(tiny_jump.item(tiny_jump.length-2)).offset().top);};
});
};
';
echo '
window.addEventListener("load",function(){
$(".message pre[class^=language-]").addClass("line-numbers");
$.getScript("plugin/tiny/prism/prism.js");
});
</script>
';
?>